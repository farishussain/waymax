<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="waymax.metrics.abstract_metric" href="abstract_metric/index.html" /><link rel="prev" title="waymax.env.typedefs" href="../env/typedefs/index.html" />

    <link rel="shortcut icon" href="https://waymo.com/favicon.png"/><!-- Generated with Sphinx 6.2.1 and Furo 2023.09.10 -->
        <title>waymax.metrics - Waymax documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?digest=369552022d0b975c8e74270ce6eabe0fb7978f24" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">Waymax  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">Waymax  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Tutorials</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../agents/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of waymax.agents</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../agents/actor_core/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.actor_core</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/agent_builder/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.agent_builder</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/constant_speed/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.constant_speed</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/expert/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.expert</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/sim_agent/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.sim_agent</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../agents/waypoint_following_agent/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.agents.waypoint_following_agent</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../dataloader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of waymax.dataloader</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/dataloader_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.dataloader_utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_dataloader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_dataloader</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_factories/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_factories</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_factories_internal/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_factories_internal</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../dataloader/womd_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.dataloader.womd_utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../datatypes/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of waymax.datatypes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/action/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.action</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/array/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.array</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/constant/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.constant</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/object_state/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.object_state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/observation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.observation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/operations/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.operations</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/roadgraph/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.roadgraph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/route/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.route</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/simulator_state/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.simulator_state</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../datatypes/traffic_lights/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.datatypes.traffic_lights</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../env/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of waymax.env</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../env/wrappers/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.wrappers</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of waymax.env.wrappers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../env/wrappers/brax_wrapper/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.wrappers.brax_wrapper</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../env/wrappers/dm_env_wrapper/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.wrappers.dm_env_wrapper</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../env/abstract_environment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.abstract_environment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/base_environment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.base_environment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/errors/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.errors</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/planning_agent_environment/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.planning_agent_environment</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/rollout/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.rollout</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../env/typedefs/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.typedefs</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of waymax.metrics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="abstract_metric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="comfort/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.comfort</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="imitation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.imitation</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="metric_factory/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.metric_factory</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="overlap/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.overlap</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="roadgraph/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.roadgraph</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="route/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.route</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../rewards/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.rewards</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of waymax.rewards</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../rewards/abstract_reward_function/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.rewards.abstract_reward_function</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../rewards/linear_combination_reward/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.rewards.linear_combination_reward</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.utils</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of waymax.utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../utils/geometry/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.utils.geometry</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils/test_utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.utils.test_utils</span></code></a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../visualization/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of waymax.visualization</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../visualization/color/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization.color</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/utils/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization.utils</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../visualization/viz/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.visualization.viz</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../config/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.config</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Further Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../py-modindex.html">Module Index</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-waymax.metrics">
<span id="waymax-metrics"></span><h1><a class="reference internal" href="#module-waymax.metrics" title="waymax.metrics"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics</span></code></a><a class="headerlink" href="#module-waymax.metrics" title="Permalink to this heading">#</a></h1>
<p>Metrics for agent evaluation.</p>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="abstract_metric/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="comfort/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.comfort</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="imitation/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.imitation</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="metric_factory/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.metric_factory</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="overlap/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.overlap</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="roadgraph/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.roadgraph</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="route/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.route</span></code></a></li>
</ul>
</div>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Permalink to this heading">#</a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.metrics.AbstractMetric" title="waymax.metrics.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AbstractMetric</span></code></a></p></td>
<td><p>Abstract class for simulator metrics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.metrics.MetricResult" title="waymax.metrics.MetricResult"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MetricResult</span></code></a></p></td>
<td><p>A metric result holding metric values and a validity mask.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.metrics.LogDivergenceMetric" title="waymax.metrics.LogDivergenceMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LogDivergenceMetric</span></code></a></p></td>
<td><p>Log divergence metric.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.metrics.OverlapMetric" title="waymax.metrics.OverlapMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OverlapMetric</span></code></a></p></td>
<td><p>Overlap metric.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.metrics.OffroadMetric" title="waymax.metrics.OffroadMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OffroadMetric</span></code></a></p></td>
<td><p>Offroad metric.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.metrics.WrongWayMetric" title="waymax.metrics.WrongWayMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WrongWayMetric</span></code></a></p></td>
<td><p>Wrong-way metric for SDC.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.metrics.OffRouteMetric" title="waymax.metrics.OffRouteMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">OffRouteMetric</span></code></a></p></td>
<td><p>Off-route metric for the SDC.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.metrics.ProgressionMetric" title="waymax.metrics.ProgressionMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ProgressionMetric</span></code></a></p></td>
<td><p>Route progression metric for SDC.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.metrics.get_metric_names" title="waymax.metrics.get_metric_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_metric_names</span></code></a>(→ collections.abc.Iterable[str])</p></td>
<td><p>Returns the names of all registered metrics.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#waymax.metrics.register_metric" title="waymax.metrics.register_metric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_metric</span></code></a>(metric_name, metric)</p></td>
<td><p>Register a metric.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#waymax.metrics.run_metrics" title="waymax.metrics.run_metrics"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run_metrics</span></code></a>(→ dict[str, ...)</p></td>
<td><p>Runs all metrics with config flags set to True.</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.AbstractMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">AbstractMetric</span></span><a class="headerlink" href="#waymax.metrics.AbstractMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Abstract class for simulator metrics.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.AbstractMetric.compute">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#waymax.metrics.MetricResult" title="waymax.metrics.MetricResult"><span class="pre">MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.AbstractMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes a per-timestep, per-object metric from a SimulatorState.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – The current simulator state of shape (…).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A MetricResult containing the metric result and validity mask of shape
(…, num_objects).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.MetricResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">MetricResult</span></span><a class="headerlink" href="#waymax.metrics.MetricResult" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../datatypes/index.html#waymax.datatypes.MaskedArray" title="waymax.datatypes.MaskedArray"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.datatypes.MaskedArray</span></code></a></p>
<p>A metric result holding metric values and a validity mask.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.metrics.MetricResult.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#waymax.metrics.MetricResult.value" title="Permalink to this definition">#</a></dt>
<dd><p>A (…) float32 array of values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.metrics.MetricResult.valid">
<span class="sig-name descname"><span class="pre">valid</span></span><a class="headerlink" href="#waymax.metrics.MetricResult.valid" title="Permalink to this definition">#</a></dt>
<dd><p>A (…) boolean validity mask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.MetricResult.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#waymax.metrics.MetricResult.validate" title="Permalink to this definition">#</a></dt>
<dd><p>Validates shape and type.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.LogDivergenceMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">LogDivergenceMetric</span></span><a class="headerlink" href="#waymax.metrics.LogDivergenceMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></code></a></p>
<p>Log divergence metric.</p>
<p>This metric returns the L2 distance between the controlled object’s XY
location and its position in the logged history at the same timestep.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.LogDivergenceMetric.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.LogDivergenceMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes log divergence by fetching correct arguments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – The current simulator state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A (…, num_objects) MetricResult containing the metric result, with L2
values representing the distance of each object from the log to the
simulated trajectory at the current timestep.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.LogDivergenceMetric.compute_log_divergence">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_log_divergence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">object_xy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_xy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax.Array</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax.Array</span></span></span><a class="headerlink" href="#waymax.metrics.LogDivergenceMetric.compute_log_divergence" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the L2 distance between <cite>object_xy</cite> and <cite>log_xy</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_xy</strong> – XY coordinates of current vehicles for the current timestep, of
shape (…, num_objects, num_timesteps, 2).</p></li>
<li><p><strong>log_xy</strong> – XY coordinates of logged vehicles for the current timestep, of
shape (…, num_objects, num_timesteps, 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A (…, num_objects, num_timesteps) array containing the metric result of</dt><dd><p>the same shape as the input trajectories.</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.metrics.get_metric_names">
<span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">get_metric_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">collections.abc.Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#waymax.metrics.get_metric_names" title="Permalink to this definition">#</a></dt>
<dd><p>Returns the names of all registered metrics.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.metrics.register_metric">
<span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">register_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#waymax.metrics.register_metric" title="Permalink to this definition">#</a></dt>
<dd><p>Register a metric.</p>
<p>This function registers a metric so that it can be included in a MetricsConfig
and computed by <cite>run_metrics</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric_name</strong> – String name to register the metric with.</p></li>
<li><p><strong>metric</strong> – The metric to register.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="waymax.metrics.run_metrics">
<span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">run_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../config/index.html#waymax.config.MetricsConfig" title="waymax.config.MetricsConfig"><span class="pre">waymax.config.MetricsConfig</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#waymax.metrics.run_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>Runs all metrics with config flags set to True.</p>
<p>User-defined metrics must be registered using the <cite>register_metric</cite> function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>simulator_state</strong> – The current simulator state of shape (…).</p></li>
<li><p><strong>metrics_config</strong> – Waymax metrics config.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A dictionary of metric names mapping to metric result arrays where each</dt><dd><p>metric is of shape (…, num_objects).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.OverlapMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">OverlapMetric</span></span><a class="headerlink" href="#waymax.metrics.OverlapMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></code></a></p>
<p>Overlap metric.</p>
<p>This metric returns 1.0 if an object’s bounding box is overlapping with
that of another object.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.OverlapMetric.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.OverlapMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes a per-timestep, per-object metric from a SimulatorState.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – The current simulator state of shape (…).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A MetricResult containing the metric result and validity mask of shape
(…, num_objects).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.OverlapMetric.compute_overlap">
<span class="sig-name descname"><span class="pre">compute_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current_traj</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.Trajectory" title="waymax.datatypes.Trajectory"><span class="pre">waymax.datatypes.Trajectory</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.OverlapMetric.compute_overlap" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the overlap metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>current_traj</strong> – Trajectory object containing current states of shape (…,
num_objects, num_timesteps=1).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A (…, num_objects) MetricResult.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.OffroadMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">OffroadMetric</span></span><a class="headerlink" href="#waymax.metrics.OffroadMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></code></a></p>
<p>Offroad metric.</p>
<p>This metric returns 1.0 if the object is offroad.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.OffroadMetric.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.OffroadMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the offroad metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – Updated simulator state to calculate metrics for. Will
compute the offroad metric for timestep <cite>simulator_state.timestep</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>An array containing the metric result of the same shape as the input</dt><dd><p>trajectories. The shape is (…, num_objects).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.WrongWayMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">WrongWayMetric</span></span><a class="headerlink" href="#waymax.metrics.WrongWayMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></code></a></p>
<p>Wrong-way metric for SDC.</p>
<p>This metric checks if SDC is driving into wrong driving the wrong way or path.
It first computes the distance to the closest roadgraph point in all valid
paths that the SDC can drive along from its starting position. If the distance
is larger than the threhold WRONG_WAY_THRES, it’s considered wrong-way and
returns the distance; otherwise, it’s driving on the legal lanes, and returns
0.0.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.metrics.WrongWayMetric.WRONG_WAY_THRES">
<span class="sig-name descname"><span class="pre">WRONG_WAY_THRES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3.5</span></em><a class="headerlink" href="#waymax.metrics.WrongWayMetric.WRONG_WAY_THRES" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.WrongWayMetric.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.WrongWayMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes a per-timestep, per-object metric from a SimulatorState.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – The current simulator state of shape (…).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A MetricResult containing the metric result and validity mask of shape
(…, num_objects).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.OffRouteMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">OffRouteMetric</span></span><a class="headerlink" href="#waymax.metrics.OffRouteMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></code></a></p>
<p>Off-route metric for the SDC.</p>
<p>The SDC is considered off-route either if 1) it is farther than
MAX_DISTANCE_TO_ROUTE_PATH from the closest on-route path, or 2) it is farther
from the closest on-route path than the closest off-route path by
MAX_RELATIVE_DISTANCE_TO_OFF_ROUTE_PATH.</p>
<p>If the SDC is on-route, the SDC trajectory is completely invalid, or there are
no valid on-route paths, it returns zero.</p>
<p>If the SDC is off-route, this metric returns the distance to the closest valid
on-route path. If there are no valid on-route paths, it returns the distance
to the closest valid off-route path.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.metrics.OffRouteMetric.MAX_DISTANCE_TO_ROUTE_PATH">
<span class="sig-name descname"><span class="pre">MAX_DISTANCE_TO_ROUTE_PATH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#waymax.metrics.OffRouteMetric.MAX_DISTANCE_TO_ROUTE_PATH" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="waymax.metrics.OffRouteMetric.MAX_RELATIVE_DISTANCE_TO_OFF_ROUTE_PATH">
<span class="sig-name descname"><span class="pre">MAX_RELATIVE_DISTANCE_TO_OFF_ROUTE_PATH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#waymax.metrics.OffRouteMetric.MAX_RELATIVE_DISTANCE_TO_OFF_ROUTE_PATH" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.OffRouteMetric.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.OffRouteMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the off route metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – The current simulator state of shape (….).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A (…) MetricResult containing the metric result described above.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <cite>simulator_state.sdc_paths</cite> is undefined.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="waymax.metrics.ProgressionMetric">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">waymax.metrics.</span></span><span class="sig-name descname"><span class="pre">ProgressionMetric</span></span><a class="headerlink" href="#waymax.metrics.ProgressionMetric" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.AbstractMetric" title="waymax.metrics.abstract_metric.AbstractMetric"><code class="xref py py-obj docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric.AbstractMetric</span></code></a></p>
<p>Route progression metric for SDC.</p>
<p>This metric returns a non-negative value representing the progression
towards the final logged position from the initial logged position along the
route. It first finds the closest on-route path to the SDC’s current xy
position according to Euclidean distance and uses that as the reference path
to compute the progress (<cite>arc_length</cite>) relative to the logged SDC’s initial
and final xy positions.</p>
<p>If the SDC trajectory is invalid or there are no valid on-route paths, it
returns zero.</p>
<dl class="py method">
<dt class="sig sig-object py" id="waymax.metrics.ProgressionMetric.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">simulator_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="../datatypes/index.html#waymax.datatypes.SimulatorState" title="waymax.datatypes.SimulatorState"><span class="pre">waymax.datatypes.SimulatorState</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="abstract_metric/index.html#waymax.metrics.abstract_metric.MetricResult" title="waymax.metrics.abstract_metric.MetricResult"><span class="pre">waymax.metrics.abstract_metric.MetricResult</span></a></span></span><a class="headerlink" href="#waymax.metrics.ProgressionMetric.compute" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the progression metric.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simulator_state</strong> – The current simulator state of shape.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A (…) MetricResult containing the metric result described above.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If <cite>simulator_state.sdc_paths</cite> is undefined.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="abstract_metric/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics.abstract_metric</span></code></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../env/typedefs/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.env.typedefs</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, The Waymax Authors
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">waymax.metrics</span></code></a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a><ul>
<li><a class="reference internal" href="#waymax.metrics.AbstractMetric"><code class="docutils literal notranslate"><span class="pre">AbstractMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.AbstractMetric.compute"><code class="docutils literal notranslate"><span class="pre">AbstractMetric.compute()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.MetricResult"><code class="docutils literal notranslate"><span class="pre">MetricResult</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.MetricResult.value"><code class="docutils literal notranslate"><span class="pre">MetricResult.value</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.MetricResult.valid"><code class="docutils literal notranslate"><span class="pre">MetricResult.valid</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.MetricResult.validate"><code class="docutils literal notranslate"><span class="pre">MetricResult.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.LogDivergenceMetric"><code class="docutils literal notranslate"><span class="pre">LogDivergenceMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.LogDivergenceMetric.compute"><code class="docutils literal notranslate"><span class="pre">LogDivergenceMetric.compute()</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.LogDivergenceMetric.compute_log_divergence"><code class="docutils literal notranslate"><span class="pre">LogDivergenceMetric.compute_log_divergence()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.get_metric_names"><code class="docutils literal notranslate"><span class="pre">get_metric_names()</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.register_metric"><code class="docutils literal notranslate"><span class="pre">register_metric()</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.run_metrics"><code class="docutils literal notranslate"><span class="pre">run_metrics()</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.OverlapMetric"><code class="docutils literal notranslate"><span class="pre">OverlapMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.OverlapMetric.compute"><code class="docutils literal notranslate"><span class="pre">OverlapMetric.compute()</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.OverlapMetric.compute_overlap"><code class="docutils literal notranslate"><span class="pre">OverlapMetric.compute_overlap()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.OffroadMetric"><code class="docutils literal notranslate"><span class="pre">OffroadMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.OffroadMetric.compute"><code class="docutils literal notranslate"><span class="pre">OffroadMetric.compute()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.WrongWayMetric"><code class="docutils literal notranslate"><span class="pre">WrongWayMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.WrongWayMetric.WRONG_WAY_THRES"><code class="docutils literal notranslate"><span class="pre">WrongWayMetric.WRONG_WAY_THRES</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.WrongWayMetric.compute"><code class="docutils literal notranslate"><span class="pre">WrongWayMetric.compute()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.OffRouteMetric"><code class="docutils literal notranslate"><span class="pre">OffRouteMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.OffRouteMetric.MAX_DISTANCE_TO_ROUTE_PATH"><code class="docutils literal notranslate"><span class="pre">OffRouteMetric.MAX_DISTANCE_TO_ROUTE_PATH</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.OffRouteMetric.MAX_RELATIVE_DISTANCE_TO_OFF_ROUTE_PATH"><code class="docutils literal notranslate"><span class="pre">OffRouteMetric.MAX_RELATIVE_DISTANCE_TO_OFF_ROUTE_PATH</span></code></a></li>
<li><a class="reference internal" href="#waymax.metrics.OffRouteMetric.compute"><code class="docutils literal notranslate"><span class="pre">OffRouteMetric.compute()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#waymax.metrics.ProgressionMetric"><code class="docutils literal notranslate"><span class="pre">ProgressionMetric</span></code></a><ul>
<li><a class="reference internal" href="#waymax.metrics.ProgressionMetric.compute"><code class="docutils literal notranslate"><span class="pre">ProgressionMetric.compute()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/scripts/furo.js"></script>
    <script src="../../../_static/design-tabs.js"></script>
    </body>
</html>